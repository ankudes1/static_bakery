


Данные авторизации не обнаруживаются в сессии
=============================================

by %s on April 20, 2011

Господа, помогите разобраться в чём дело. Новичок в CakePHP. Делал всё
согласно примера в документации http://book.cakephp.org/#!/view/1543
/Simple-Acl-controlled-Application , но столкнулся с тем что
авторизация не проходит. Попробовал простую авторизацию, не могу
понять, в сессии нет данных после входа пользователя. Причём при вводе
неправильного логина/пароля выдаёт сообщение об этом. А если верные
вводишь - происходит редирект, и всё. Данных в сессии найти не могу,
соответственно никакие проверки что пользователь вошёл не
проходят.Такое ощущение, что проверку пользователь проходит а сессию
данные не попадают.
Господа, помогите разобраться в чём дело.
Новичок в CakePHP. Делал всё согласно примера в документации
`http://book.cakephp.org/#!/view/1543/Simple-Acl-controlled-
Application`_ , но столкнулся с тем что авторизация не проходит.
Попробовал простую авторизацию, не могу понять, в сессии нет данных
после входа пользователя. Причём при вводе неправильного логина/пароля
выдаёт сообщение об этом. А если верные вводишь - происходит редирект,
и всё. Данных в сессии найти не могу, соответственно никакие проверки
что пользователь вошёл не проходят.Такое ощущение, что проверку
пользователь проходит а сессию данные не попадают.
При записи напрямую в сессию например так:


PHP Snippet:
````````````

::

    <?php $this->Session->write('Person.eyeColor', 'Green');?>

при выводе


PHP Snippet:
````````````

::

    <?php var_dump($_SESSION);?>


отображается всё верно.
В чём может быть дело?
На всякий случай код:
app_controller.php


PHP Snippet:
````````````

::

    <?php class AppController extends Controller {
        var $components = array('Auth', 'Session');
        var $helpers = array('Html', 'Form', 'Session');
        
        function beforeFilter() {
            //Configure AuthComponent
            $this->Auth->allowedActions = array('index','view','display');
            $this->Auth->authorize = 'controller';
            $this->Auth->loginAction = array('controller' => 'users', 'action' => 'login');
            $this->Auth->logoutRedirect = array('controller' => 'users', 'action' => 'logout');
            $this->Auth->loginRedirect = array('controller' => 'users', 'action' => 'index');
        }
        
        function isAuthorized() {
            return true;
        }
    }
    ?>


login.ctp


PHP Snippet:
````````````

::

    <?php echo $session->read('Auth.User.name'); 
        var_dump($_SESSION);?>




Login
-----


PHP Snippet:
````````````

::

    <?php 
        echo $this->Form->create('User', array('url' => array('controller' => 'users', 'action' =>'login')));
        echo $this->Form->input('User.username');
        echo $this->Form->input('User.password');
        echo $this->Form->end('Login');
    ?>


users_controller.php


PHP Snippet:
````````````

::

    <?php class UsersController extends AppController {
    
    	var $name = 'Users';
      
    	function login() {
        }
     
        function logout() {
            $this->Session->setFlash('Good-Bye');
            $this->redirect($this->Auth->logout());
        } 
    }
    ?>




.. _http://book.cakephp.org/#!/view/1543/Simple-Acl-controlled-Application: http://book.cakephp.org/#!/view/1543/Simple-Acl-controlled-Application

.. meta

::

    :title: Данные авторизации не обнаруживаются в сессии
    :description: CakePHP Article related to ,Code
    :keywords: ,Code
    :copyright: Copyright 2011 
    :category: code


